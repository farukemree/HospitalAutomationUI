<div class="doctor-page-container">
  <!-- Main Content -->
  <div class="main-content">
    

    <!-- Appointments Section -->
    <div class="section appointments-section">
      <div class="section-header">
        <h2><i class="fas fa-calendar-alt"></i> Randevu Yönetimi</h2>
        <button class="btn-refresh" (click)="getAppointments()">
          <i class="fas fa-sync-alt"></i> Randevuları Getir
        </button>
      </div>

      <!-- Add/Update Appointment Form -->
      <div class="appointment-form-container">
        <h3>
          <i class="fas fa-plus-circle" *ngIf="!isUpdateMode"></i>
          <i class="fas fa-edit" *ngIf="isUpdateMode"></i>
          {{isUpdateMode ? 'Randevu Güncelle' : 'Yeni Randevu Ekle'}}
        </h3>
        
        <form class="appointment-form">
          <div class="form-row">
            <div class="form-group">
              <label for="patientId"><i class="fas fa-user"></i> Hasta TC</label>
              <input 
                type="number" 
                id="patientId" 
                [(ngModel)]="newAppointment.patientId" 
                name="patientId"
                placeholder="Hasta ID giriniz"
                required
              />
            </div>
            
            <div class="form-group">
              <label for="appointmentDate"><i class="fas fa-calendar"></i> Randevu Tarihi</label>
              <input 
                type="datetime-local" 
                id="appointmentDate" 
                [(ngModel)]="newAppointment.appointmentDate" 
                name="appointmentDate"
                required
              />
            </div>
          </div>
          
          <div class="form-group">
            <label for="description"><i class="fas fa-clipboard"></i> Açıklama</label>
            <textarea 
              id="description" 
              [(ngModel)]="newAppointment.description" 
              name="description"
              placeholder="Randevu açıklaması giriniz"
              rows="3"
            ></textarea>
          </div>
          
          <div class="form-actions">
            <button 
              type="button" 
              class="btn-primary" 
              (click)="isUpdateMode ? updateAppointmentById() : addAppointment()"
            >
              <i class="fas fa-save"></i>
              {{isUpdateMode ? 'Güncelle' : 'Ekle'}}
            </button>
            
            <button 
              type="button" 
              class="btn-secondary" 
              (click)="isUpdateMode ? cancelUpdate() : resetNewAppointment()"
            >
              <i class="fas fa-times"></i>
              {{isUpdateMode ? 'İptal' : 'Temizle'}}
            </button>
          </div>
        </form>
      </div>

      <!-- Get Appointment by ID -->
      <div class="get-appointment-container">
        <h3><i class="fas fa-search"></i> ID ile Randevu Ara</h3>
        <div class="search-form">
          <input 
            type="number" 
            [(ngModel)]="appointmentIdToFetch" 
            placeholder="Randevu ID giriniz"
            class="search-input"
          />
          <button class="btn-search" (click)="getAppointmentById()">
            <i class="fas fa-search"></i> Ara
          </button>
        </div>
      </div>

      <!-- Selected Appointment Details -->
      <div class="appointment-details" *ngIf="selectedAppointment">
        <div class="details-header">
          <h3><i class="fas fa-info-circle"></i> Randevu Detayları</h3>
          <button class="btn-close" (click)="closeAppointmentDetails()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="details-content">
          <div class="detail-item">
            <strong>ID:</strong> {{selectedAppointment.id}}
          </div>
          <div class="detail-item">
            <strong>Hasta ID:</strong> {{selectedAppointment.patientId}}
          </div>
          <div class="detail-item">
            <strong>Doktor ID:</strong> {{selectedAppointment.doctorId}}
          </div>
          <div class="detail-item">
            <strong>Tarih:</strong> {{selectedAppointment.appointmentDate | date:'dd/MM/yyyy HH:mm'}}
          </div>
          <div class="detail-item">
            <strong>Açıklama:</strong> {{selectedAppointment.description}}
          </div>
        </div>
      </div>

      <!-- Appointments List -->
      <div class="appointments-list" *ngIf="appointments.length > 0; else noAppointments">
        <h3><i class="fas fa-list"></i> Randevu Listesi</h3>
        <div class="appointments-grid">
          <div class="appointment-card" *ngFor="let appointment of appointments">
            <div class="appointment-info">
              <div class="appointment-header">
                <span class="appointment-id">ID: {{appointment.id}}</span>
                <span class="appointment-date">{{appointment.appointmentDate | date:'dd/MM/yyyy HH:mm'}}</span>
              </div>
              <div class="appointment-body">
                <p><strong>Hasta ID:</strong> {{appointment.patientId}}</p>
                <p><strong>Açıklama:</strong> {{appointment.description}}</p>
              </div>
            </div>
            <div class="appointment-actions">
              <button class="btn-edit-sm" (click)="startUpdate(appointment)">
                <i class="fas fa-edit"></i> Düzenle
              </button>
              <button class="btn-delete-sm" (click)="deleteAppointmentById(appointment.id!)">
                <i class="fas fa-trash"></i> Sil
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <ng-template #noAppointments>
        <div class="no-data">
          <i class="fas fa-calendar-times"></i>
          <p>Henüz randevu bulunmamaktadır.</p>
          <button class="btn-refresh" (click)="getAppointments()">
            <i class="fas fa-sync-alt"></i> Randevuları Getir
          </button>
        </div>
      </ng-template>
    </div>

  </div>
</div>