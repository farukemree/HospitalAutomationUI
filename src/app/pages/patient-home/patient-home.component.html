<div class="container">
  <div class="container mt-4">
  <h2>ğŸ§  HastalÄ±k Tahmini</h2>
  <div class="mb-3">
    <label for="symptomInput" class="form-label">SemptomlarÄ±nÄ±zÄ± girin:</label>
    <input type="text" class="form-control" id="symptomInput" [(ngModel)]="symptomInput" placeholder="Ã–rnek: nefes darlÄ±ÄŸÄ±, Ã¶ksÃ¼rÃ¼k, hÄ±rÄ±ltÄ±" />
  </div>
  <button class="btn btn-primary mb-3" (click)="predictDisease()">Tahmin Et</button>

  <div *ngIf="predictedDisease" class="alert alert-info">
    âœ… Tahmin Edilen HastalÄ±k: <strong>{{ predictedDisease }}</strong>
  </div>
    <div class="mt-4 mb-4">
    <h4>ğŸ’¬ Yapay Zeka Destekli SaÄŸlÄ±k AsistanÄ±</h4>
    <app-chatbox></app-chatbox>
  </div>
</div>
  <!-- Doktor Listesi -->
  <section class="doctor-list mb-5 card-section">
    <h2 class="section-title">Doktor Listesi</h2>

    <ul *ngIf="doctors.length > 0; else noDoctors" class="list-group">
      <li *ngFor="let doctor of doctors" class="list-group-item d-flex justify-content-between align-items-center doctor-item">
        <div class="doctor-info d-flex align-items-center gap-3">
          <img 
            [src]="doctor.imageUrl" 
            alt="Doktor FotoÄŸrafÄ±" 
            class="doctor-img"
            onerror="this.src='assets/default-doctor.png'" />
          <div>
            <strong>{{ doctor.fullName }}</strong> <br>
            <small class="text-muted">{{ doctor.specialization }}</small>
          </div>
        </div>
        <span class="badge badge-info badge-pill">ğŸ“ {{ doctor.phone }}</span>
      </li>
    </ul>

    <ng-template #noDoctors>
      <p class="text-warning text-center mt-3">HenÃ¼z doktor listesi yÃ¼klenmedi veya boÅŸ.</p>
    </ng-template>
  </section>

  <hr>

  <!-- Randevu OluÅŸtur / GÃ¼ncelle -->
  <section class="appointment-create mb-5 card-section">
    <h2 class="section-title">{{ editingAppointment ? 'Randevuyu GÃ¼ncelle' : 'Randevu OluÅŸtur' }}</h2>
    <form (ngSubmit)="onSubmit()" #appointmentForm="ngForm" class="form">

      <div class="form-group mb-3">
        <label for="doctor">Doktor SeÃ§:</label>
       <!-- Doktor seÃ§imi isme gÃ¶re -->
<select class="form-select" [(ngModel)]="selectedDoctorName" name="doctorName" (change)="onDoctorNameChange()" required>
  <option value="" disabled selected>Doktor seÃ§in</option>
  <option *ngFor="let doc of doctors" 
          [value]="doc.fullName"
          [disabled]="isDoctorAlreadyBooked(doc.id)">
    {{ doc.fullName }} 
  </option>
</select>


      </div>

   <!-- Tarih seÃ§imi -->
<div class="form-group mb-3">
  <label for="date">Randevu Tarihi:</label>
  <input
    class="form-control"
    type="date"
    [(ngModel)]="selectedDate"
    name="selectedDate"
    (change)="onDateChange()"
    required
  />
</div>

 <!-- Saat SeÃ§imi -->
<div class="form-group mb-3">
  <label for="timeSlot">Randevu Saati:</label>
  <select
    class="form-control"
    [(ngModel)]="selectedTime"
    name="selectedTime"
    required
  >
    <option *ngFor="let slot of availableTimeSlots"
            [value]="slot.time"
            [disabled]="slot.disabled">
      {{ slot.time }} {{ slot.disabled ? '(Dolu)' : '' }}
    </option>
  </select>
</div>


<div class="form-group mb-4">
  <label for="description">AÃ§Ä±klama:</label>
  <textarea
    class="form-control"
    id="description"
    [(ngModel)]="appointment.description"
    name="description"
    rows="3"
    placeholder="Åikayetinizi veya aÃ§Ä±klamanÄ±zÄ± girin..."
  ></textarea>
</div>


      <button type="submit" class="btn btn-success w-100">
        {{ editingAppointment ? 'GÃ¼ncelle' : 'OluÅŸtur' }}
      </button>
    </form>
  </section>

  <hr>

  <!-- RandevularÄ±m -->
  <section class="my-appointments mb-5 card-section">
    <h2 class="section-title">RandevularÄ±m</h2>
   

    <ul *ngIf="appointments.length > 0; else noAppointments" class="list-group">
      <li *ngFor="let app of appointments" class="list-group-item d-flex justify-content-between align-items-center appointment-item">
        <div>
          <strong>ğŸ“… Tarih:</strong> {{ app.appointmentDate | date:'short' }} <br>
          <strong>ğŸ‘¨â€âš•ï¸ Doktor:</strong> {{ app.doctorName }} <br>
          <strong>ğŸ“ AÃ§Ä±klama:</strong> {{ app.description || '-' }}
        </div>
        <div class="btn-group">
          <button class="btn btn-sm btn-warning me-2" (click)="startEditAppointment(app)">DÃ¼zenle</button>
          <button class="btn btn-sm btn-danger" (click)="deleteAppointment(app.id!)">Sil</button>
        </div>
      </li>
    </ul>

    <ng-template #noAppointments>
      <p class="text-muted text-center mt-3">HenÃ¼z randevunuz yok veya henÃ¼z yÃ¼klenmedi .</p>
    </ng-template>
  </section>

  <hr>

  <<section class="medical-records card-section">
  <h2 class="section-title">TÄ±bbi KayÄ±tlarÄ±m</h2>

  <ul *ngIf="medicalRecords.length > 0; else noMedicalRecords" class="list-group">
    <li *ngFor="let record of medicalRecords" class="list-group-item medical-record-item">
      <div>
        <strong>ğŸ“… Tarih:</strong> {{ record.recordDate | date:'short' }} <br>
        <strong>ğŸ“ TanÄ±:</strong> {{ getDiagnosis(record.description) }}
      </div>
    </li>
  </ul>

  <ng-template #noMedicalRecords>
    <p class="text-muted text-center mt-3">HenÃ¼z tÄ±bbi kayÄ±t bulunmamaktadÄ±r.</p>
  </ng-template>
</section>



</div>
